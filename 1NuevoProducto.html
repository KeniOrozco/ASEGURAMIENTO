<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuevo Producto</title>
    <link rel="stylesheet" href="../ASEGURAMIENTO/bootstrap-5.0.2-dist/css/bootstrap.min.css">
    <script src="http://code.jquery.com/jquery.js"> </script>
    <script src="../bootstrap-5.0.2-dist/js/bootstrap.min.js"> </script>

    <!-- enlace del css de la pagina principal de menu-->
    <link rel="stylesheet" href="css/menu.css">

    <link rel="stylesheet" href="font.css.css">
    <link rel="stylesheet" href="main.css">
    
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    
    
</head>
<body>


  
  <div id="banner3"> Gle Always </div>
  <div id="banner">  

      <div id="header" >
          <ul class="nav">
              <li><a href="menu.html">Inicio</a></li>
              <li><a href="">Productos</a>
                  <ul>
                      <li><a href="1NuevoProducto.html">Nuevos Productos</a></li>
                      <li><a href="">Para él</a></li>
                      <li><a href="">Para ella</a></li>       
                  </ul>
              </li>
  
              <li><a href="">Ofertas</a> </li>
  
              <li><a href="">Quienes Somos</a></li>
              <li><a href="contacto.html">Contacto</a></li>
              <li><a href="">Más</a>
                  <ul>
                      <li><a href="">Existencia</a></li>       
                      <li><a href="">Administrador</a>
                          <ul>
                              <li><a href="">Ventas</a></li> 
                              <li><a href="">Proveedores</a></li>       
                          </ul>
                      </li>       
                      <li><a href="">Clientes</a>
                          <ul>
                              <li><a href="">Mayoristas</a></li> 
                          </ul>
                      </li>       
                  </ul>
              </li>
          </ul>
      </div>



  </div>
<br><br><br><br><br> <br>



<!-- informacion de los productos -->
<script>
  window.onload = function () {
    // Variables
    const baseDeDatos = [
        {
            id: 1,
            nombre: 'Brocha difuminadora para sombras Mary Kay®',
            precio: 90,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2021/05/Brocha-difuminadora-para-sombras-Mary-Kay%C2%AE.png'
        },
        {
            id: 2,
            nombre: 'Mascarilla de Arcilla Rosa Mary Kay®',
            precio: 160,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2021/05/Crema-de-arcilla-Mary-Kay.png'
        },
        {
            id: 3,
            nombre: 'Brillos Labiales Mary Kay® Unlimited™ Promoción',
            precio: 106.25,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2021/02/1041709-UNL-GB-154-SOLDIER-UNLIMITED-LIP-GLOSS-FANCY-NANCY.jpg'
        },
        {
            id: 4,
            nombre: 'Gel Limpiador Facial Mkmen®',
            precio: 95,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2018/10/Gel-limpiador-facial-mkmen.png'
        },
        {
            id: 5,
            nombre: 'Fragancia High Intensity sport®',
            precio: 314,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2019/05/Fragancia-High-Intensity-sport%C2%AE.png'
        },
        {
            id: 6,
            nombre: 'Set TimeWise® 3D™ FPS30 (N-S)',
            precio: 700,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2021/05/Juego-Milagroso-TimeWise-3D-con-FPS-NS.png'
        },
        {
            id: 7,
            nombre: 'Protector Solar con Amplia Protección FPS 50 Mary Kay®',
            precio: 250,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2018/11/protector-solar-50.png'
        },
        {
            id: 8,
            nombre: 'Crema Facial para el día Efecto Reparador TimeWise® Repair® Volu Firm® Mary Kay®',
            precio: 400,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2021/05/Crema-Facial-para-dia-Efecto-Reparador-TimeWise-Repair.png'
        },
        {
            id: 9,
            nombre: 'Base preliminar para maquillaje Mary Kay® FPS 15',
            precio: 140,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2019/05/base-preliminar-para-maquillaje.png'
        },
        {
            id: 10,
            nombre: 'Loción Humectante FPS 30 Botanical Effects® Mary Kay®',
            precio: 176,
            imagen: 'https://marykay.com.gt/wp-content/uploads/2018/10/Locio%CC%81n-humectante-fps-30-botanical-effects.png'
        }
        
        

    ];

    let carrito = [];
    let total = 0;
    const DOMitems = document.querySelector('#items');
    const DOMcarrito = document.querySelector('#carrito');
    const DOMtotal = document.querySelector('#total');
    const DOMbotonVaciar = document.querySelector('#boton-vaciar');

    // Funciones

    /**
    * Dibuja todos los productos a partir de la base de datos. No confundir con el carrito
    */
    function renderizarProductos() {
        baseDeDatos.forEach((info) => {
            // Estructura
            const miNodo = document.createElement('div');
            miNodo.classList.add('card', 'col-sm-4');
            // Body
            const miNodoCardBody = document.createElement('div');
            miNodoCardBody.classList.add('card-body');
            // Titulo
            const miNodoTitle = document.createElement('h5');
            miNodoTitle.classList.add('card-title');
            miNodoTitle.textContent = info.nombre;
            // Imagen
            const miNodoImagen = document.createElement('img');
            miNodoImagen.classList.add('img-fluid');
            miNodoImagen.setAttribute('src', info.imagen);
            // Precio
            const miNodoPrecio = document.createElement('p');
            miNodoPrecio.classList.add('card-text');
            miNodoPrecio.textContent = info.precio + 'Q';
            // Boton 
            const miNodoBoton = document.createElement('button');
            miNodoBoton.classList.add('btn', 'btn-primary');
            miNodoBoton.textContent = 'Añadir al carrito';
            miNodoBoton.setAttribute('marcador', info.id);
            miNodoBoton.addEventListener('click', anyadirProductoAlCarrito);
            // Insertamos
            miNodoCardBody.appendChild(miNodoImagen);
            miNodoCardBody.appendChild(miNodoTitle);
            miNodoCardBody.appendChild(miNodoPrecio);
            miNodoCardBody.appendChild(miNodoBoton);
            miNodo.appendChild(miNodoCardBody);
            DOMitems.appendChild(miNodo);
        });
    }

    /**
    * Evento para añadir un producto al carrito de la compra
    */
    function anyadirProductoAlCarrito(evento) {
        // Anyadimos el Nodo a nuestro carrito
        carrito.push(evento.target.getAttribute('marcador'))
        // Calculo el total
        calcularTotal();
        // Actualizamos el carrito 
        renderizarCarrito();

    }

    /**
    * Dibuja todos los productos guardados en el carrito
    */
    function renderizarCarrito() {
        // Vaciamos todo el html
        DOMcarrito.textContent = '';
        // Quitamos los duplicados
        const carritoSinDuplicados = [...new Set(carrito)];
        // Generamos los Nodos a partir de carrito
        carritoSinDuplicados.forEach((item) => {
            // Obtenemos el item que necesitamos de la variable base de datos
            const miItem = baseDeDatos.filter((itemBaseDatos) => {
                // ¿Coincide las id? Solo puede existir un caso
                return itemBaseDatos.id === parseInt(item);
            });
            // Cuenta el número de veces que se repite el producto
            const numeroUnidadesItem = carrito.reduce((total, itemId) => {
                // ¿Coincide las id? Incremento el contador, en caso contrario no mantengo
                return itemId === item ? total += 1 : total;
            }, 0);
            // Creamos el nodo del item del carrito
            const miNodo = document.createElement('li');
            miNodo.classList.add('list-group-item', 'text-right', 'mx-2');
            miNodo.textContent = `${numeroUnidadesItem} x ${miItem[0].nombre} - ${miItem[0].precio}Q`;
            // Boton de borrar
            const miBoton = document.createElement('button');
            miBoton.classList.add('btn', 'btn-danger', 'mx-5');
            miBoton.textContent = 'X';
            miBoton.style.marginLeft = '1rem';
            miBoton.dataset.item = item;
            miBoton.addEventListener('click', borrarItemCarrito);
            // Mezclamos nodos
            miNodo.appendChild(miBoton);
            DOMcarrito.appendChild(miNodo);
        });
    }

    /**
    * Evento para borrar un elemento del carrito
    */
    function borrarItemCarrito(evento) {
        // Obtenemos el producto ID que hay en el boton pulsado
        const id = evento.target.dataset.item;
        // Borramos todos los productos
        carrito = carrito.filter((carritoId) => {
            return carritoId !== id;
        });
        // volvemos a renderizar
        renderizarCarrito();
        // Calculamos de nuevo el precio
        calcularTotal();
    }

    /**
    * Calcula el precio total teniendo en cuenta los productos repetidos
    */
    function calcularTotal() {
        // Limpiamos precio anterior
        total = 0;
        // Recorremos el array del carrito
        carrito.forEach((item) => {
            // De cada elemento obtenemos su precio
            const miItem = baseDeDatos.filter((itemBaseDatos) => {
                return itemBaseDatos.id === parseInt(item);
            });
            total = total + miItem[0].precio;
        });
        // Renderizamos el precio en el HTML
        DOMtotal.textContent = total.toFixed(2);
    }

    /**
    * Varia el carrito y vuelve a dibujarlo
    */
    function vaciarCarrito() {
        // Limpiamos los productos guardados
        carrito = [];
        // Renderizamos los cambios
        renderizarCarrito();
        calcularTotal();
    }

    // Eventos
    DOMbotonVaciar.addEventListener('click', vaciarCarrito);

    // Inicio
    renderizarProductos();


  } 
</script>

<!-- contenedor de los elementos del carrito-->
<div class="container">
  <div class="row">
      <!-- Elementos generados a partir del JSON -->
      <main id="items" class="col-sm-8 row"></main>
      <!-- Carrito -->
      <aside class="col-sm-4">
          <h2>Carrito</h2>
          <!-- Elementos del carrito -->
          <ul id="carrito" class="list-group"></ul>
          <hr>
          <!-- Precio total -->
          <p class="text-right">Total: <span id="total"></span>Q</p>
          <button id="boton-vaciar" class="btn btn-danger">Vaciar</button>
      </aside>
  </div>
</div>

  
  <!-- Banner de las redes sociales -->
  <div class="Social-bar">
    <a href="https://www.facebook.com/kini.xd/" class="icon icon-facebook"></a>
    <a href="https://www.instagram.com/?hl=es" class="icon icon-instagram"></a>
    <a href="https://web.whatsapp.com/" class="icon icon-whatsapp"></a>
    <a href="https://www.youtube.com/" class="icon icon-youtube"></a>
    <a href="https://twitter.com/?lang=es" class="icon icon-twitter"></a>
</div>
      
    


</body>
</html>